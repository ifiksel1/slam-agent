/**:
  ros__parameters:
    # ========================================
    # MAVROS Configuration for ArduPilot
    # Hardware: Cube Orange (Pixhawk 2.1)
    # Serial: /dev/ttyUSB0 @ 921600 baud
    # Protocol: MAVLink v2.0
    # ========================================

    # ========================================
    # Connection Configuration
    # ========================================

    # FCU connection URL
    # Format: device:baudrate
    # Override via launch file parameter
    fcu_url: "/dev/ttyUSB0:921600"

    # Ground Control Station URL (empty = disabled)
    gcs_url: ""

    # MAVLink system/component IDs
    target_system_id: 1        # ArduPilot system ID
    target_component_id: 1     # Autopilot component
    system_id: 1               # This system's ID
    component_id: 191          # Onboard computer component ID (191 = typical)

    # MAVLink protocol version (2.0 recommended)
    mavlink_version: 2.0

    # ========================================
    # Plugin Configuration
    # ========================================

    # Enable/disable specific plugins
    plugin_blacklist: []
    plugin_whitelist:
      - sys_status
      - sys_time
      - imu
      - gps
      - battery
      - command
      - local_position
      - global_position
      - setpoint_position
      - setpoint_velocity
      - setpoint_attitude
      - rc_io
      - param
      - waypoint
      - vision_pose
      - vision_speed
      - odometry

    # ========================================
    # System Configuration
    # ========================================

    sys:
      # Heartbeat rate (Hz)
      heartbeat_rate: 1.0

      # System status rate (Hz)
      sys_status_rate: 1.0

      # Connection timeout (seconds)
      timeout: 5.0

      # Time synchronization
      time_sync_rate: 10.0
      timesync_mode: MAVLINK  # Options: MAVLINK, ONBOARD, PASSTHROUGH

    # ========================================
    # IMU Configuration (for EKF fusion)
    # ========================================

    imu:
      # Frame ID for IMU messages
      frame_id: "base_link"

      # Orientation covariance (3x3 diagonal)
      # Set to -1 to use autopilot values
      orientation_cov: -1.0

      # Linear acceleration covariance
      linear_acceleration_cov: 0.0001

      # Angular velocity covariance
      angular_velocity_cov: 0.0001

      # Magnetic field covariance
      magnetic_field_cov: 0.0

    # ========================================
    # GPS Configuration
    # ========================================

    gps:
      # Frame ID for GPS messages
      frame_id: "base_link"

      # GPS fix type (for diagnostics)
      min_fix_type: 3  # 3 = 3D fix

    # ========================================
    # Local Position (EKF output)
    # ========================================

    local_position:
      # Frame IDs
      frame_id: "map"
      child_frame_id: "base_link"

      # Publish TF transform
      tf_send: true

      # TF frame prefix (empty = no prefix)
      tf_frame_id: "map"
      tf_child_frame_id: "base_link"

    # ========================================
    # Vision Pose (SLAM -> ArduPilot)
    # ========================================
    # This is the critical configuration for SLAM integration

    vision_pose:
      # Enable vision pose estimation
      enable: true

      # Frame IDs
      frame_id: "map"
      child_frame_id: "base_link"

      # Publish TF
      tf_send: false  # SLAM already publishes TF

      # Vision pose topic rate limit (Hz)
      # 0 = no limit (publish every message)
      rate_limit: 30.0

      # Covariance for vision pose
      # 6x6 covariance matrix (x, y, z, roll, pitch, yaw)
      # -1 = use SLAM output covariance
      # Otherwise, diagonal values:
      linear_cov: 0.01    # Position covariance (m^2)
      angular_cov: 0.01   # Orientation covariance (rad^2)

    # ========================================
    # Vision Speed (optional)
    # ========================================

    vision_speed:
      # Enable vision speed estimation
      enable: true

      # Speed covariance
      speed_cov: 0.1

    # ========================================
    # Odometry Plugin (unified interface)
    # ========================================

    odometry:
      # Frame IDs
      frame_id: "map"
      child_frame_id: "base_link"

      # Publish TF
      tf_send: false  # SLAM handles TF

      # Covariance
      # -1 = use input covariance
      pose_cov: -1.0
      twist_cov: -1.0

    # ========================================
    # Setpoint Position (for SLAM-based navigation)
    # ========================================

    setpoint_position:
      # Frame ID for position setpoints
      frame_id: "map"

      # Setpoint rate (Hz)
      rate: 50.0

      # TF listener timeout (seconds)
      tf_listen: true
      tf_timeout: 1.0

    # ========================================
    # Setpoint Velocity
    # ========================================

    setpoint_velocity:
      # Frame ID
      frame_id: "base_link"

      # Rate (Hz)
      rate: 50.0

    # ========================================
    # Setpoint Attitude
    # ========================================

    setpoint_attitude:
      # Use quaternion (true) or euler angles (false)
      use_quaternion: true

      # Frame ID
      frame_id: "base_link"

      # Rate (Hz)
      rate: 50.0

    # ========================================
    # RC Input/Output
    # ========================================

    rc_io:
      # RC override timeout (seconds)
      rc_override_timeout: 1.0

    # ========================================
    # Parameter Server
    # ========================================

    param:
      # Parameter sync rate (Hz)
      # 0 = sync once at startup
      sync_rate: 0.0

      # Parameter request timeout (seconds)
      request_timeout: 5.0

    # ========================================
    # Waypoint/Mission
    # ========================================

    waypoint:
      # Use mission protocol (QGC WPL format)
      use_mission_item_int: true

      # Pull missions on connect
      pull_after_gcs: false

    # ========================================
    # Safety Configuration
    # ========================================

    safety:
      # Enable safety pilot override
      # (RC can override SLAM commands)
      enable_rc_override: true

      # Battery failsafe
      battery_failsafe_voltage: 14.0  # Volts (for 4S LiPo)

    # ========================================
    # Transform Configuration
    # ========================================

    # Static transform: SLAM frame -> ArduPilot frame
    # ArduPilot uses NED (North-East-Down)
    # ROS uses ENU (East-North-Up)
    # Transformation: NED -> ENU requires 180Â° rotation about X axis

    transforms:
      # SLAM odometry frame
      slam_frame: "map"

      # ArduPilot local frame
      fcu_frame: "odom"

      # Body frame
      body_frame: "base_link"

      # Coordinate frame transformation (ENU <-> NED)
      # This is handled automatically by MAVROS
      fcu_uses_ned: true  # ArduPilot uses NED

    # ========================================
    # ArduPilot-Specific Parameters
    # ========================================

    ardupilot:
      # Vehicle type (copter, plane, rover, sub)
      vehicle_type: "copter"

      # EKF3 vision fusion parameters
      # These should be set on the autopilot via parameters:
      #
      # EK3_SRC1_POSXY = 6  (ExternalNav for horizontal position)
      # EK3_SRC1_VELXY = 6  (ExternalNav for horizontal velocity)
      # EK3_SRC1_POSZ  = 1  (Baro for altitude)
      # EK3_SRC1_VELZ  = 6  (ExternalNav for vertical velocity)
      # EK3_SRC1_YAW   = 6  (ExternalNav for yaw)
      #
      # VISO_TYPE = 2       (MAV_ODOMETRY_POS_NED for position)
      # VISO_DELAY_MS = 50  (Latency compensation, tune as needed)
      # VISO_POS_M_NSE = 0.1  (Position noise, tune based on SLAM performance)
      # VISO_YAW_M_NSE = 0.1  (Yaw noise)
      # VISO_VEL_M_NSE = 0.2  (Velocity noise)
      #
      # GPS_TYPE = 0        (Disable GPS for indoor/vision-only)
      # OR
      # EK3_GPS_CHECK = 0   (Disable GPS checks, fuse GPS + vision outdoor)

      # Flight mode for vision position control
      vision_flight_mode: "GUIDED"

    # ========================================
    # Debug/Logging
    # ========================================

    debug:
      # Enable debug output
      debug: false

      # Log all MAVLink messages
      log_mavlink: false

      # Publish raw IMU data
      publish_raw_imu: true

      # Publish diagnostics
      publish_diagnostics: true
